from flask import Flask, request
from datetime import datetime
from openpyxl import load_workbook
from openpyxl.drawing.image import Image as XLImage
from openpyxl.utils import get_column_letter
import os, base64
from flask import render_template_string
from openpyxl.styles import Border, Side

app = Flask(__name__)

CARPETA_FIRMAS = os.path.join("data", "firmas")
os.makedirs(CARPETA_FIRMAS, exist_ok=True)
ARCHIVO_EXCEL = os.path.join("data", "registros.xlsx")



# Logo en base64 (verde SENA)
logo_base64 = ("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wgARCAEsA4QDASIAAhEBAxEB/8QAGgABAAMBAQEAAAAAAAAAAAAAAAMEBQIBBv/EABkBAQADAQEAAAAAAAAAAAAAAAABAgMEBf/aAAwDAQACEAMQAAAC3wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAChWt/z57jLD6V85ftbUee67gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUsexX5OIKZgaGr859F0dXo23AAAAAAAAAAAAAAAAAAAHJ0oRmjDWkPfPB73GLMtCM02ZbLAAAAAAAAAAAAAAAAAAAAAAAAAAPneLVXi88IgB9F8/9Fv0ejfpAAAAAAAAAAAAAAAAAAeQ0jvyWAnintGb3oRREPXllFbj22Z3lydND2zSmeblf0vs3RPQAAAAAAAAAAAAAAAAAAAAAAAVcT6WpjhirEOHNyl0bW40jp7AtYAAAAAAAAAZ1a6LI0YrML6AAAAAKfsR55zfK92OpFLNO7mRlsYmrnHunia6KVqt0iPzjyM9fvnKt1aWfqp0qVe5i11lah6AAAAAAAAAAAAAAAAAZ1a6L5+PPH6R831D6Jk62uphQZ5fSPm0R9I+bsTO4r4dr/SPm7Fabjz3XcwoMsPpFazruMKtN1837nn9Ghm23CZAAAAYe5h5YVtvE2887Q6esAAABDNlHfPVw77ZkUs0NPmM5srq6jqjJem1Tu0WoeaBGRNdhilezSsoj5r7J1nX+rdFOusJuKdwAAAAAAAAAAAAAAAA8+c+ko5Y5F6GHDn2ametbR0MbZ01xYJ4MOa/Yyvb6akuNeve5hbuFWpNapnHsfN39Na8E8GWO5Zre9XbVzPe+bkmq72Pa3W781p2tpDo6gAAAGHuYeWFbbxNvPO0OnrAAAHhR6h8JrzlFOntU64ZupUtq+WvaM9Fylxem1BpjM90vCCxUqmlk6vkZSVa8UU518i2rdztOjbqh06nBfAAAAAAAAAAAAAAABxib2fljS1MuPPHUyepIivrcaN9cKC5FnjbtZS+mqyupnUwt7IiPN/G2b3xan0ePnnV8nUz08uxBfSD3Q1D5t9Itb5r2/Wzy2JsnW6OoL6AAAMPcw8sK23ibeedodPWAAAp3Mwk9j0DrE2+YzypPPI55r3NWemKyszd57Ad+e8w7749l156Mu/LlGnkbEcZczZ0EVt3crWm2Y97nW+ilAAAAAAAAAAAAAAHPWRSmm+eZYfQvnh9C+eH0L54fQvnh9C+eH0L56SZ+g98926EfeBTPcfPM8voXzw+hfPD6F88PoXzw+hfPD6Hr5y5Ntkb9AAADD3MPLCtt4m3nnaHT1gAAMzRoHOnm6RR5npV5rUUF0tZtju3TYBzzJWJZIuTztBCZ1wTw+yyoWaWnEQTZKMNTvKtTdzZqTr7ezdIAAAAAAAAAAAAAAZGvVpniNZhz5LWGS1hktYZLVza14FaNehu7dArb9FmncI+aWqvHwjqI5avumuS1hktYZLWGTctS2taHR1AAAMPcw8sK23ibeedodPWAABDVsVz2/RvGRHtq4ZN6ZNs/RztKdVexXh1HHOO+uJeec9w7j8EvfHcs6/StmY1lcMfQspszdLMnVp5mmAAAAAAAAAAAAAAAAAAAMLRxsOYXcsL9k6++HBtVObk3bGDvbbwYX0mTWlCaFhz/AEqje6+4LWAAAAAAAYe5h5YVtvE2887Q6esAACGrdonV/K9OvefYc6eePNLLuyn89Fbv3uDx4cy8xym956AM+9naZHzn9Qvd14paGboUTjTzdIAAAAAAAAAAAAAAAAAAee5taUYjk4et+jpb9SnbwLTEOXka2T1a/wBHw76+353jVyuTi7+g+c0b31B09YAAAAAADD3MPLCtt4m3nnaHT1gAAM3SzBp5mkegKlKMtbPmjXvx85s21GPbLqh6Xmd3C8oUpbyGoSaHGZGeszLpMJ0rRcdnl+CcAAAAAAAAAAAAAAAAAAjwLlHm40kexWtz1H1dtHM985OEl2rWwFmtSl7X+a3Nuixg79S98X3xy8f0EuNs9faF9AAAAAAGHuYeWFbbxNvPO0OnrAAAUrvJSkg5NLH2kZ49m9RjOHVz+kw3pc62/lHTsmE1IzPaNgzNT2kd2fZyHP7nrzqnnjO9br8T01k3E30QAAAAAAAAAAAAAAAAAK9jDzyrDl47O5XsdXaxtDDpmLWPPfuHZ3Q4P0mXljnTwMOf6VnaPX3YtTfwefl828SeI3h19oAAAAADD3MPLCtt4m3nnaHT1gAAAZ3V7MLVrL0jrP7hrhFJDPGOh3neW3uU9H2dcxpk5jTFK57XitjPitso4e6cZ7vlG/PQy+5JvFoUr4AAAAAAAAAAAAAAAAAPIinjyR8vEvU/oLW7M/fqoQnJw+71HU36Q23c9Ij56PXyOXi63/nrtrbGVq879Pzjvjk4dXQ+d3+jr7GuwAAAACraRWjb7QC1gAAAFayM+Kb0u0I9GKQ9zYynGxDMjMlh6jHTjjrzvcrV7cU5p6lJGjkaSby+ZusvXjcL+wNKZ7AAAAAAAAAAAAAAAAAAgnRHzfm1l8vHe0fPenr4+fuUcOZJHsVpc9OrtCZAYe5DnngPfOXi27WBvdXZRyfpcHPKHbju2uG24AAAAAAAAAAAAChfFCKzXLkHPMVtw2a6nFSS1GPdebheC/XgRoKWlOuRrwRFmh5NN/IPdJPMgAAAAAAAAAAAAAAAAAAAPPQr2KNaZPnXnJw2NyGbq7QvoAABlZ/0eBzckepmX4rq+eursBIAAAAAAAAAAAAAACOQZcmhCVOffCSeuLPtXyIvVox3F15M8yxTEM1z0AAAAAAAAAAAAAAAAAAAAAAA4r21ahawAAACtZREcgBMgAAAAAAAAAAAAAAAAAAQwXRnNEZ3V8VbHQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//aAAwDAQACAAMAAAAh8888888888888888888888888888888888888888888888888888888888888888888888+vR888888888888888888888888888888888888888888888888888888+++z88888888888888888888484gk8488888888888888888888888888X++t8888888888888888888g8My/umYE8888888888888888888888888/34+88888888886/wDPPPPPNMO3yv0zyOGMPPPPPPPPPPPPPPPPPPvfsNf/AHT3fXzXrbzzzzz3/wA8888ksSWz8PtLK6R488888888888888888IqObX+sX7YX+W/P888889/88888kVLo7QcsUlfEcs88888888888888887NN2YgQb1/Qqyx4/8APPPPf/PPPOPOAN9KCvPBOdvJPPPPPPPPPPPPPPPKv/8A/wD/AP8Ajd//AP8A/wD/APq88889/wDPPPNHI3hPBLBrvJm8ONPPPPPPPPPPPPPPLMssstvtvPd/8sssoPPPPPf/ADzzyhz5XTLLy5LxwrxzTzzzzzzzzzzzzzzzzzzyz3zZ+2x7zzzzzzzz3/zzzwyB7oyxI5zTxT5wDTzzzzzzzzzzzzzzzzzz11fH67Zb/wA88888889/8888oc44ms4gy0Mf38wc88888888888888888819a/02es/188888889/wDPPPLEOPrvJOGCJPhP/PPPPPPPPPPPPPPPPPPO/wB7b/0mx5rrTzzzzzz3/wA88880Yq3ZN88bJc/EM888888888888888887dpu8+8/c5498888888tu88888s4H1dJ9TpN0ycc88888888888888888s2c8tf88q30XO88888888888888sEi1JTqMwVQ8888888888888888888885R088887l988888888888888888okASiswU88888888888888888888888u88888sf8888888888888888888scsMs88888888888888888888888888888888888888888888888888888888888888888888888//9oADAMBAAIAAwAAABDzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzztHDzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzyAMPbzzzzzzzzzzzzzzzzzzzzjCChAzjzzzzzzzzzzzzzzzzzzzzzzzzzwMMN7zzzzzzzzzzzzzzzzzzyBiT+b97RTzzzzzzzzzzzzzzzzzzzzzzzzx4QHTzzzzzzzzzzznzzzzzyiwwOZAl+KCxzzzzzzzzzzzzzzzzzzjjPHDHejPfD7PT3zzzzylbzzzzyAw0MZk3tfUgTDTzzzzzzzzzzzzzzzw4JRKvGUONONIoaTzzzzylbzzzzwBkoJpixxSpqujTzzzzzzzzzzzzzzzxzGhy0wkQyszUENz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")

def escribir_en_excel(data, firma_path):
    wb = load_workbook(ARCHIVO_EXCEL)
    ws = wb.active
    fila = 8
    while ws.cell(row=fila, column=5).value not in (None, ""):
        fila += 1

    fecha = datetime.now()
    meses = ["", "Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]

    ws.cell(row=fila, column=1, value=fecha.year)
    ws.cell(row=fila, column=2, value=meses[fecha.month])
    ws.cell(row=fila, column=3, value=fecha.day)
    ws.cell(row=fila, column=4, value=fecha.strftime('%H:%M'))  # Hora de ingreso

    ws.cell(row=fila, column=5, value=data['nombres'])
    ws.cell(row=fila, column=6, value=data['documento'])
    ws.cell(row=fila, column=7, value=data['motivo'])
    ws.cell(row=fila, column=8, value=data['eps'])
    ws.cell(row=fila, column=9, value=data['arl'])
    ws.cell(row=fila, column=10, value=data['autoriza'])
    ws.cell(row=fila, column=11, value=data['acudiente'])
    ws.cell(row=fila, column=12, value=data['celular'])

    # Firma en columna 13 (M)
    img = XLImage(firma_path)
    img.width = 120
    img.height = 50
    ws.add_image(img, f"{get_column_letter(13)}{fila}")
    ws.row_dimensions[fila].height = 60

    # Columna 14: hora de salida
    ws.cell(row=fila, column=14, value="")


    ws.cell(row=fila, column=15, value=data.get("observaciones", ""))

    borde = Border(
        left=Side(style="thin"),
        right=Side(style="thin"),
        top=Side(style="thin"),
        bottom=Side(style="thin")
    )

    for col in range(1, 16):  # A (1) hasta O (15)
        ws.cell(row=fila, column=col).border = borde

    wb.save(ARCHIVO_EXCEL)


@app.route("/")
def inicio():
    return render_template_string(f"""
    <!DOCTYPE html>
    <html>
    <head>
        <style>
            body {{
                font-family: Arial, sans-serif;
                background: #f4f4f4;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                margin: 0;
            }}
            .container {{
                background: white;
                padding: 30px;
                border-radius: 12px;
                text-align: center;
                box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            }}
            .logo {{
                width: 300px;
                margin-bottom: 15px;
            }}
            h1 {{
                color: #007C3E;
                font-weight: bold;
            }}
            .btn {{
                background: #007C3E;
                color: white;
                padding: 10px 20px;
                margin: 10px;
                border: none;
                border-radius: 8px;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
            }}
            .btn:hover {{
                background: #005f2d;
            }}
        </style>
    </head>
    <body>
        <div class="container">
            <img src="{logo_base64}" class="logo">
            <h1>Registro de Asistencia</h1>
            <a href="/registrar" class="btn">Registrar Ingreso</a>
            <a href="/salida" class="btn">Registrar Salida</a>
        </div>
    </body>
    </html>
    """)


@app.route("/registrar", methods=["GET", "POST"])
def registrar():
    if request.method == "POST":
        documento = request.form["documento"]

        if ya_esta_adentro(documento):
            return mostrar_mensaje_exito("‚ùå Ya registr√≥ ingreso y no ha registradosu salida salida.")

        datos = {
            'nombres': request.form["nombres"],
            'documento': request.form["documento"],
            'motivo': request.form["motivo"],
            'eps': request.form["eps"],
            'arl': request.form["arl"],
            'autoriza': request.form["autoriza"],
            'acudiente': request.form["acudiente"],
            'celular': request.form["celular"],

        }

        firma_data = request.form["firma"]
        nombre_firma = f"{datos['documento']}_{datetime.now().strftime('%H%M%S')}.png"
        ruta_firma = os.path.join(CARPETA_FIRMAS, nombre_firma)

        with open(ruta_firma, "wb") as f:
            f.write(base64.b64decode(firma_data.split(",")[1]))

        escribir_en_excel(datos, ruta_firma)
        return mostrar_mensaje_exito("‚úî Registro de ingreso exitoso")

    return render_template_string(r"""
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registrar Ingreso - SENA</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; }
        header { background-color: #007C3E; color: white; padding: 20px; text-align: center; }
        .container { max-width: 700px; margin: 30px auto; background: white; padding: 30px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1); border-radius: 10px; }
        input[type="text"], input[type="tel"], select {
            width: 100%; padding: 10px; margin: 10px 0;
            border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box;
        }
        button {
            background-color: #007C3E; color: white; padding: 10px 20px;
            border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;
        }
        button:hover { background-color: #005f2d; }
        canvas { border: 1px solid #ccc; margin-top: 10px; }
        a { display: inline-block; margin-top: 20px; color: #007C3E; text-decoration: none; }
        .modal {
            display: none; position: fixed; z-index: 999; left: 0; top: 0;
            width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);
            justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #fff; border-radius: 10px; padding: 20px;
            width: 90%; max-width: 500px; box-shadow: 0 0 10px #333; color: #333;
        }
        .modal-header {
            font-weight: bold; font-size: 20px; margin-bottom: 15px; color: #007C3E;
        }
        .modal-buttons {
            text-align: right; margin-top: 20px;
        }
        .modal-buttons button { margin-left: 10px; }
        .alerta {
            background-color: #f44336; color: white; padding: 10px;
            margin: 10px 0; border-radius: 5px; display: none;
        }
    </style>
</head>
<body>
<header>
    <h1>Registro de Ingreso al laboratorio </h1>
</header>
<div class="container">
    <div class="alerta" id="alertaError"></div>
    <form method="POST" id="formulario">
        <label>Nombre y Apellido:</label>
        <input type="text" name="nombres" id="nombres" oninput="soloLetras(this)">

        <label>Documento de Identificaci√≥n:</label>
        <input type="text" name="documento" id="documento" oninput="soloNumeros(this)">


        <label>Motivo de Visita:</label>
        <select name="motivo" id="motivo">
            <option value="" disabled selected>Seleccione un motivo</option>
            <option value="Transferencia de conocimiento">Transferencia de conocimiento</option>
            <option value="Asesor√≠a de gesti√≥n de mantenimiento">Asesor√≠a de gesti√≥n de mantenimiento</option>
            <option value="Solicitud de servicios del laboratorio">Solicitud de servicios del laboratorio</option>
        </select>

        <label>EPS:</label>
        <input type="text" name="eps" id="eps">

        <label>ARL:</label>
        <select name="arl" id="arl">
            <option value="" disabled selected>Seleccione una ARL</option>
            <option value="SURA">SURA</option>
            <option value="Colpatria">Colpatria</option>
            <option value="Positiva">Positiva</option>
            <option value="AXA Colpatria">AXA Colpatria</option>
            <option value="Bol√≠var">Bol√≠var</option>
            <option value="La Equidad">La Equidad</option>
            <option value="Alfa">Alfa</option>
            <option value="Ninguna">Ninguna</option>
        </select>

        <label>Qui√©n autoriza el ingreso:</label>
        <select name="autoriza" id="autoriza">
            <option value="" disabled selected>Seleccione quien autoriza</option>
            <option value="Personal t√©cnico">Personal t√©cnico</option>
            <option value="Responsable del laboratorio">Responsable del laboratorio</option>
            <option value="Responsable del sistema de gesti√≥n">Responsable del sistema de gesti√≥n</option>
        </select>

        <label>Persona en caso de emergencia:</label>
        <input type="text" name="acudiente" id="acudiente">

        <label>Tel√©fono de persona en caso de emergencia:</label>
        <input type="tel" name="celular" id="celular" oninput="soloNumeros(this)" maxlength="10">

        <label>Firma:</label><br>
        <canvas id="canvas" width="300" height="100"></canvas><br>
        <button type="button" onclick="limpiarCanvas()">Limpiar Firma</button><br>

        <input type="hidden" name="firma" id="firma">
        <button type="button" onclick="validarYMostrar()">Registrar</button>
    </form>
    <a href="/">Volver al Inicio</a>
</div>

<div class="modal" id="modal">
    <div class="modal-content">
        <div class="modal-header">¬øLos datos ingresados son correctos?</div>
        <div id="resumen"></div>
        <div class="modal-buttons">
            <button onclick="cerrarModal()">No, corregir</button>
            <button onclick="enviarFormulario()">S√≠, registrar</button>
        </div>
    </div>
</div>

<script>
function mostrarError(mensaje) {
    const alerta = document.getElementById("alertaError");
    alerta.innerText = mensaje;
    alerta.style.display = "block";
    setTimeout(() => alerta.style.display = "none", 4000);
}

function validarYMostrar() {
    const nombre = document.getElementById("nombres").value.trim();
    const documento = document.getElementById("documento").value.trim();
    const celular = document.getElementById("celular").value.trim();

    // üëá Aqu√≠ se corrigi√≥ \\s en la expresi√≥n regular
    if (!/^[A-Za-z√Å√â√ç√ì√ö√°√©√≠√≥√∫√ë√±\s]+$/.test(nombre)) {

        mostrarError("El nombre solo debe contener letras y espacios.");
        return;
    }

   if (!/^\d+$/.test(documento)) {
    mostrarError("El documento solo debe contener n√∫meros.");
    return;
}


    if (!/^\d{10}$/.test(celular)) {
        mostrarError("El n√∫mero de tel√©fono debe tener exactamente 10 d√≠gitos num√©ricos.");
        return;
    }

    const campos = [
        { id: "motivo", nombre: "Motivo de Visita" },
        { id: "eps", nombre: "EPS" },
        { id: "arl", nombre: "ARL" },
        { id: "autoriza", nombre: "Qui√©n autoriza el ingreso" },
        { id: "acudiente", nombre: "Persona en caso de emergencia" }
    ];

    for (let campo of campos) {
        const valor = document.getElementById(campo.id).value.trim();
        if (valor === "") {
            mostrarError("El campo '" + campo.nombre + "' es obligatorio.");
            return;
        }
    }

    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const pixel = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
    let vacio = true;
    for (let i = 0; i < pixel.length; i++) {
        if (pixel[i] !== 0) {
            vacio = false;
            break;
        }
    }
    if (vacio) {
        mostrarError("Por favor dibuje su firma antes de continuar.");
        return;
    }

    mostrarConfirmacion();
}

function guardarFirma() {
    var canvas = document.getElementById("canvas");
    var dataUrl = canvas.toDataURL();
    document.getElementById("firma").value = dataUrl;
}

function limpiarCanvas() {
    var canvas = document.getElementById("canvas");
    var ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}

function mostrarConfirmacion() {
    guardarFirma();

    const campos = [
        { id: "nombres", nombre: "Nombres" },
        { id: "documento", nombre: "Documento de Identificaci√≥n" },
        { id: "motivo", nombre: "Motivo de Visita" },
        { id: "eps", nombre: "EPS" },
        { id: "arl", nombre: "ARL" },
        { id: "autoriza", nombre: "Qui√©n autoriza el ingreso" },
        { id: "acudiente", nombre: "Persona en caso de emergencia" },
        { id: "celular", nombre: "Tel√©fono de persona en caso de emergencia" }
    ];

    let resumen = "<ul style='list-style:none; padding-left:0'>";
    campos.forEach(campo => {
        const valor = document.getElementById(campo.id).value.trim();
        resumen += `<li><strong>${campo.nombre}:</strong> ${valor}</li>`;
    });
    resumen += "</ul>";

    document.getElementById("resumen").innerHTML = resumen;
    document.getElementById("modal").style.display = "flex";
}

function cerrarModal() {
    document.getElementById("modal").style.display = "none";
}

function enviarFormulario() {
    document.getElementById("modal").style.display = "none";
    document.getElementById("formulario").submit();
}

// Bloqueo en tiempo real
function soloLetras(input) {
    input.value = input.value.replace(/[^a-zA-Z√Å√â√ç√ì√ö√°√©√≠√≥√∫√ë√±\s]/g, '');
}

function soloNumeros(input) {
    input.value = input.value.replace(/[^0-9]/g, '');
}

// Canvas para firma
window.onload = function () {
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    let dibujando = false;

    canvas.style.touchAction = "none";

    function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        if (e.touches && e.touches.length > 0) {
            return {
                x: e.touches[0].clientX - rect.left,
                y: e.touches[0].clientY - rect.top
            };
        } else {
            return {
                x: e.offsetX,
                y: e.offsetY
            };
        }
    }

    function empezarDibujo(e) {
        dibujando = true;
        const pos = getPos(e);
        ctx.beginPath();
        ctx.moveTo(pos.x, pos.y);
    }

    function dibujar(e) {
        if (!dibujando) return;
        e.preventDefault();
        const pos = getPos(e);
        ctx.lineWidth = 2;
        ctx.lineCap = "round";
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(pos.x, pos.y);
    }

    function terminarDibujo() {
        dibujando = false;
        ctx.beginPath();
    }

    canvas.addEventListener("mousedown", empezarDibujo);
    canvas.addEventListener("mousemove", dibujar);
    canvas.addEventListener("mouseup", terminarDibujo);
    canvas.addEventListener("mouseleave", terminarDibujo);

    canvas.addEventListener("touchstart", empezarDibujo);
    canvas.addEventListener("touchmove", dibujar);
    canvas.addEventListener("touchend", terminarDibujo);
};
</script>
</body>
</html>

""")

def ya_esta_adentro(documento):
    wb = load_workbook(ARCHIVO_EXCEL)
    ws = wb.active
    for row in ws.iter_rows(min_row=7, values_only=True):  # Asumes que los datos inician en fila 7
        doc = str(row[5]).strip()  # DOCUMENTO DE IDENTIFICACI√ìN
        salida = row[13]           # HORA DE SALIDA (columna N)
        if doc == documento and (salida is None or str(salida).strip() == ""):
            return True
    return False


def mostrar_mensaje_exito(mensaje):
    return render_template_string("""
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Estado del Registro</title>
        <style>
            body {
                background-color: #e8f5e9; /* Verde claro */
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                margin: 0;
            }
            .contenedor {
                background: white;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 5px 20px rgba(0, 128, 0, 0.2);
                text-align: center;
            }
            .icono {
                font-size: 60px;
                color: green; /* ‚ùå roja */
            }
            h2 {
                color: #2e7d32; /* Verde oscuro */
            }
            a {
                margin-top: 20px;
                display: inline-block;
                padding: 10px 20px;
                background-color: #2e7d32;
                color: white;
                text-decoration: none;
                border-radius: 5px;
            }
            a:hover {
                background-color: #1b5e20;
            }
        </style>
    </head>
    <body>
        <div class="contenedor">
            <div class="icono">‚úî</div>
            <h2>{{ mensaje }}</h2>
            <a href="/">Volver al inicio</a>
        </div>
    </body>
    </html>
    """, mensaje=mensaje)

def mostrar_mensaje_error(mensaje):
    return render_template_string("""
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Documento No Encontrado</title>
        <style>
            body {
                background-color: #e8f5e9;
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                margin: 0;
            }
            .contenedor {
                background: white;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 5px 20px rgba(0, 128, 0, 0.2);
                text-align: center;
            }
            .icono {
                font-size: 60px;
                color: red;
            }
            h2 {
                color: #2e7d32;
            }
            a {
                margin-top: 20px;
                display: inline-block;
                padding: 10px 20px;
                background-color: #2e7d32;
                color: white;
                text-decoration: none;
                border-radius: 5px;
            }
            a:hover {
                background-color: #1b5e20;
            }
        </style>
    </head>
    <body>
        <div class="contenedor">
            <div class="icono">‚úò</div>
            <h2>{{ mensaje }}</h2>
            <p>Por favor verifique el n√∫mero de documento.</p>
            <a href="/salida">Intentar de nuevo</a>
        </div>
    </body>
    </html>
    """, mensaje=mensaje)


@app.route("/salida", methods=["GET", "POST"])
def salida():
    if request.method == "POST":
        documento = request.form["documento"]
        observaciones = request.form.get("observaciones", "")

        wb = load_workbook(ARCHIVO_EXCEL)
        ws = wb.active

        fila = 8
        encontrada = False
        while ws.cell(row=fila, column=6).value:
            if str(ws.cell(row=fila, column=6).value) == documento and ws.cell(row=fila, column=14).value in (None, ""):
                encontrada = True
                hora_salida = datetime.now().strftime("%H:%M")
                ws.cell(row=fila, column=14, value=hora_salida)
                ws.cell(row=fila, column=15, value=observaciones)

                # ‚úÖ Aplicar bordes a toda la fila (1 a 15)
                from openpyxl.styles import Border, Side
                borde = Border(
                    left=Side(style='thin'),
                    right=Side(style='thin'),
                    top=Side(style='thin'),
                    bottom=Side(style='thin')
                )
                for col in range(1, 16):
                    ws.cell(row=fila, column=col).border = borde

                break
            fila += 1

        if encontrada:
            wb.save(ARCHIVO_EXCEL)
            return mostrar_mensaje_exito("Ya registr√≥ ingreso y no ha registrado salida.")

        else:
            return mostrar_mensaje_error("‚ùå No se encontr√≥ una salida pendiente para esa c√©dula")

    # Interfaz HTML
    return render_template_string("""
  <!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro de Salida</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 30px;
        }
        h2 {
            color: #007C3E;
            text-align: center;
        }
        form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 400px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border-radius: 4px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        button {
            background-color: #007C3E;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #005f2d;
        }
        a {
            display: block;
            margin-top: 20px;
            text-align: center;
            color: #007C3E;
        }
        .alerta {
            background-color: #f44336;
            color: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            display: none;
            text-align: center;
        }
    </style>
</head>
<body>

<h2>Registrar Hora de Salida</h2>

<div class="alerta" id="alertaError"></div>

<form method="POST" id="formSalida">
    <label>Documento de Identidad:</label>
 <input type="text" name="documento" id="documento" oninput="soloNumeros(this)">

    <label>Observaciones:</label>
    <input type="text" name="observaciones" id="observaciones">

    <button type="submit">Registrar Salida</button>
</form>

<a href="/">Volver</a>

<script>
    function soloNumeros(input) {
        input.value = input.value.replace(/[^0-9]/g, '');
    }

    function mostrarError(mensaje) {
        const alerta = document.getElementById("alertaError");
        alerta.innerText = mensaje;
        alerta.style.display = "block";
        setTimeout(() => alerta.style.display = "none", 4000);
    }

    document.getElementById("formSalida").addEventListener("submit", function(e) {
        const doc = document.getElementById("documento").value.trim();
        
    if (!/^\d+$/.test(doc)) {
        mostrarError("El documento solo debe contener n√∫meros.");
        e.preventDefault(); // evita env√≠o si hay error
        return;
    }
    });
</script>

</body>
</html>

    """)

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000, debug=True)
